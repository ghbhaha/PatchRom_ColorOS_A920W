*** /home/suda/color2.0/device/temp/android_smali/./services.jar.out/smali/com/android/server/pm/PackageManagerService.smali	2014-05-01 23:28:52.000000000 +0800
--- ./services.jar.out/smali/com/android/server/pm/PackageManagerService.smali	2014-05-01 23:29:07.000000000 +0800
***************
*** 579,584 ****
--- 579,589 ----
      .parameter "installer"
      .parameter "factoryTest"
      .parameter "onlyCore"
+     .annotation build Landroid/annotation/OppoHook;
+         level = .enum Landroid/annotation/OppoHook$OppoHookType;->CHANGE_CODE:Landroid/annotation/OppoHook$OppoHookType;
+         note = "Jianjun.Dan@Plf.SDK, add to load oppo-framework-resWangLan@Plf.Framework, modify for shareuid, store preset APK in /system/reserve, parse packages.xml to confirm its validity"
+         property = .enum Landroid/annotation/OppoHook$OppoRomType;->ROM:Landroid/annotation/OppoHook$OppoRomType;
+     .end annotation
  
      .prologue
      invoke-direct/range {p0 .. p0}, Landroid/content/pm/IPackageManager$Stub;-><init>()V
***************
*** 870,875 ****
--- 875,882 ----
  
      invoke-static {v2, v3, v4}, Landroid/util/EventLog;->writeEvent(IJ)I
  
+     invoke-static {}, Lcom/android/server/pm/OppoPackageManagerHelper;->ParsePackageXml()V
+ 
      const/4 v2, 0x0
  
      move-object/from16 v0, p0
***************
*** 1815,1820 ****
--- 1822,1833 ----
  
      move-object/from16 v0, p0
  
+     move-object/from16 v1, v24
+ 
+     invoke-direct {v0, v1}, Lcom/android/server/pm/PackageManagerService;->ignoreOppoFrameworkRes(Ljava/util/HashSet;)V
+ 
+     move-object/from16 v0, p0
+ 
      iget-object v2, v0, Lcom/android/server/pm/PackageManagerService;->mFrameworkDir:Ljava/io/File;
  
      invoke-virtual {v2}, Ljava/io/File;->list()[Ljava/lang/String;
***************
*** 8944,8949 ****
--- 8957,8967 ----
      .locals 22
      .parameter "pkg"
      .parameter "replace"
+     .annotation build Landroid/annotation/OppoHook;
+         level = .enum Landroid/annotation/OppoHook$OppoHookType;->CHANGE_CODE:Landroid/annotation/OppoHook$OppoHookType;
+         note = "wanglan modify for near id"
+         property = .enum Landroid/annotation/OppoHook$OppoRomType;->ROM:Landroid/annotation/OppoHook$OppoRomType;
+     .end annotation
  
      .prologue
      move-object/from16 v0, p1
***************
*** 9056,9062 ****
  
      .local v9, i:I
      :goto_2
!     if-ge v9, v2, :cond_1b
  
      move-object/from16 v0, p1
  
--- 9074,9080 ----
  
      .local v9, i:I
      :goto_2
!     if-ge v9, v2, :cond_1c
  
      move-object/from16 v0, p1
  
***************
*** 9155,9167 ****
      invoke-static/range {v19 .. v20}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
  
      :cond_3
!     if-eqz v6, :cond_1a
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->packageSetting:Lcom/android/server/pm/PackageSettingBase;
  
      move-object/from16 v19, v0
  
!     if-eqz v19, :cond_1a
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->name:Ljava/lang/String;
  
--- 9173,9185 ----
      invoke-static/range {v19 .. v20}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
  
      :cond_3
!     if-eqz v6, :cond_1b
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->packageSetting:Lcom/android/server/pm/PackageSettingBase;
  
      move-object/from16 v19, v0
  
!     if-eqz v19, :cond_1b
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->name:Ljava/lang/String;
  
***************
*** 9243,9249 ****
      invoke-static/range {v19 .. v20}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
  
      :cond_6
!     if-eqz v4, :cond_18
  
      move-object/from16 v0, v17
  
--- 9261,9267 ----
      invoke-static/range {v19 .. v20}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I
  
      :cond_6
!     if-eqz v4, :cond_19
  
      move-object/from16 v0, v17
  
***************
*** 9311,9317 ****
  
      move-result v19
  
!     if-eqz v19, :cond_15
  
      move-object/from16 v0, p1
  
--- 9329,9335 ----
  
      move-result v19
  
!     if-eqz v19, :cond_16
  
      move-object/from16 v0, p1
  
***************
*** 9333,9339 ****
  
      move/from16 v1, v20
  
!     if-ge v0, v1, :cond_15
  
      const/4 v4, 0x1
  
--- 9351,9357 ----
  
      move/from16 v1, v20
  
!     if-ge v0, v1, :cond_16
  
      const/4 v4, 0x1
  
***************
*** 9383,9389 ****
      .end local v10           #ip:I
      .end local v13           #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
      :cond_7
!     if-eqz v4, :cond_17
  
      iget-object v0, v8, Lcom/android/server/pm/GrantedPermissions;->grantedPermissions:Ljava/util/HashSet;
  
--- 9401,9407 ----
      .end local v10           #ip:I
      .end local v13           #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
      :cond_7
!     if-eqz v4, :cond_18
  
      iget-object v0, v8, Lcom/android/server/pm/GrantedPermissions;->grantedPermissions:Ljava/util/HashSet;
  
***************
*** 9397,9403 ****
  
      move-result v19
  
!     if-nez v19, :cond_16
  
      const/4 v7, 0x1
  
--- 9415,9421 ----
  
      move-result v19
  
!     if-nez v19, :cond_17
  
      const/4 v7, 0x1
  
***************
*** 9477,9483 ****
  
      move/from16 v0, v19
  
!     if-ne v11, v0, :cond_14
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->packageSetting:Lcom/android/server/pm/PackageSettingBase;
  
--- 9495,9501 ----
  
      move/from16 v0, v19
  
!     if-ne v11, v0, :cond_15
  
      iget-object v0, v6, Lcom/android/server/pm/BasePermission;->packageSetting:Lcom/android/server/pm/PackageSettingBase;
  
***************
*** 9529,9542 ****
  
      move-result v19
  
!     if-nez v19, :cond_f
  
      :cond_c
      const/4 v4, 0x1
  
      .restart local v4       #allowed:Z
      :goto_6
!     if-nez v4, :cond_d
  
      iget v0, v6, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
--- 9547,9583 ----
  
      move-result v19
  
!     if-nez v19, :cond_10
  
      :cond_c
      const/4 v4, 0x1
  
      .restart local v4       #allowed:Z
      :goto_6
!     move-object/from16 v0, p1
! 
!     iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;
! 
!     move-object/from16 v19, v0
! 
!     if-eqz v19, :cond_d
! 
!     move-object/from16 v0, p1
! 
!     iget-object v0, v0, Landroid/content/pm/PackageParser$Package;->mSharedUserId:Ljava/lang/String;
! 
!     move-object/from16 v19, v0
! 
!     invoke-static/range {v19 .. v19}, Lcom/android/server/pm/OppoPackageManagerHelper;->IsShareUid(Ljava/lang/String;)Z
! 
!     move-result v19
! 
!     if-eqz v19, :cond_d
! 
!     const/4 v4, 0x1
! 
!     :cond_d
!     if-nez v4, :cond_e
  
      iget v0, v6, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
***************
*** 9544,9562 ****
  
      and-int/lit8 v19, v19, 0x10
  
!     if-eqz v19, :cond_d
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_d
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_12
  
      move-object/from16 v0, p0
  
--- 9585,9603 ----
  
      and-int/lit8 v19, v19, 0x10
  
!     if-eqz v19, :cond_e
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_e
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_13
  
      move-object/from16 v0, p0
  
***************
*** 9581,9587 ****
  
      move-object/from16 v19, v0
  
!     if-eqz v19, :cond_10
  
      move-object/from16 v0, v18
  
--- 9622,9628 ----
  
      move-object/from16 v19, v0
  
!     if-eqz v19, :cond_11
  
      move-object/from16 v0, v18
  
***************
*** 9601,9615 ****
  
      move-result v19
  
!     if-eqz v19, :cond_11
  
      const/4 v4, 0x1
  
      .end local v14           #origGp:Lcom/android/server/pm/GrantedPermissions;
      .end local v18           #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_d
      :goto_8
!     if-nez v4, :cond_e
  
      iget v0, v6, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
--- 9642,9656 ----
  
      move-result v19
  
!     if-eqz v19, :cond_12
  
      const/4 v4, 0x1
  
      .end local v14           #origGp:Lcom/android/server/pm/GrantedPermissions;
      .end local v18           #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_e
      :goto_8
!     if-nez v4, :cond_f
  
      iget v0, v6, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
***************
*** 9617,9633 ****
  
      and-int/lit8 v19, v19, 0x20
  
!     if-eqz v19, :cond_e
  
      invoke-virtual/range {v15 .. v16}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_13
  
      const/4 v4, 0x1
  
!     :cond_e
      :goto_9
      if-eqz v4, :cond_5
  
--- 9658,9674 ----
  
      and-int/lit8 v19, v19, 0x20
  
!     if-eqz v19, :cond_f
  
      invoke-virtual/range {v15 .. v16}, Ljava/util/HashSet;->contains(Ljava/lang/Object;)Z
  
      move-result v19
  
!     if-eqz v19, :cond_14
  
      const/4 v4, 0x1
  
!     :cond_f
      :goto_9
      if-eqz v4, :cond_5
  
***************
*** 9636,9673 ****
      goto/16 :goto_3
  
      .end local v4           #allowed:Z
!     :cond_f
      const/4 v4, 0x0
  
      goto :goto_6
  
      .restart local v4       #allowed:Z
      .restart local v18       #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_10
      move-object/from16 v14, v18
  
      goto :goto_7
  
      .restart local v14       #origGp:Lcom/android/server/pm/GrantedPermissions;
!     :cond_11
      const/4 v4, 0x0
  
      goto :goto_8
  
      .end local v14           #origGp:Lcom/android/server/pm/GrantedPermissions;
      .end local v18           #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_12
      const/4 v4, 0x1
  
      goto :goto_8
  
!     :cond_13
      const/4 v4, 0x0
  
      goto :goto_9
  
      .end local v4           #allowed:Z
!     :cond_14
      const/4 v4, 0x0
  
      .restart local v4       #allowed:Z
--- 9677,9714 ----
      goto/16 :goto_3
  
      .end local v4           #allowed:Z
!     :cond_10
      const/4 v4, 0x0
  
      goto :goto_6
  
      .restart local v4       #allowed:Z
      .restart local v18       #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_11
      move-object/from16 v14, v18
  
      goto :goto_7
  
      .restart local v14       #origGp:Lcom/android/server/pm/GrantedPermissions;
!     :cond_12
      const/4 v4, 0x0
  
      goto :goto_8
  
      .end local v14           #origGp:Lcom/android/server/pm/GrantedPermissions;
      .end local v18           #sysPs:Lcom/android/server/pm/PackageSetting;
!     :cond_13
      const/4 v4, 0x1
  
      goto :goto_8
  
!     :cond_14
      const/4 v4, 0x0
  
      goto :goto_9
  
      .end local v4           #allowed:Z
!     :cond_15
      const/4 v4, 0x0
  
      .restart local v4       #allowed:Z
***************
*** 9676,9682 ****
      .restart local v3       #NP:I
      .restart local v10       #ip:I
      .restart local v13       #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
!     :cond_15
      add-int/lit8 v10, v10, 0x1
  
      goto/16 :goto_4
--- 9717,9723 ----
      .restart local v3       #NP:I
      .restart local v10       #ip:I
      .restart local v13       #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
!     :cond_16
      add-int/lit8 v10, v10, 0x1
  
      goto/16 :goto_4
***************
*** 9684,9690 ****
      .end local v3           #NP:I
      .end local v10           #ip:I
      .end local v13           #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
!     :cond_16
      move-object/from16 v0, v17
  
      iget-boolean v0, v0, Lcom/android/server/pm/PackageSetting;->haveGids:Z
--- 9725,9731 ----
      .end local v3           #NP:I
      .end local v10           #ip:I
      .end local v13           #npi:Landroid/content/pm/PackageParser$NewPermissionInfo;
!     :cond_17
      move-object/from16 v0, v17
  
      iget-boolean v0, v0, Lcom/android/server/pm/PackageSetting;->haveGids:Z
***************
*** 9711,9717 ****
  
      goto/16 :goto_5
  
!     :cond_17
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
--- 9752,9758 ----
  
      goto/16 :goto_5
  
!     :cond_18
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
***************
*** 9762,9768 ****
  
      goto/16 :goto_5
  
!     :cond_18
      iget-object v0, v8, Lcom/android/server/pm/GrantedPermissions;->grantedPermissions:Ljava/util/HashSet;
  
      move-object/from16 v19, v0
--- 9803,9809 ----
  
      goto/16 :goto_5
  
!     :cond_19
      iget-object v0, v8, Lcom/android/server/pm/GrantedPermissions;->grantedPermissions:Ljava/util/HashSet;
  
      move-object/from16 v19, v0
***************
*** 9775,9781 ****
  
      move-result v19
  
!     if-eqz v19, :cond_19
  
      const/4 v7, 0x1
  
--- 9816,9822 ----
  
      move-result v19
  
!     if-eqz v19, :cond_1a
  
      const/4 v7, 0x1
  
***************
*** 9885,9891 ****
  
      goto/16 :goto_5
  
!     :cond_19
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
--- 9926,9932 ----
  
      goto/16 :goto_5
  
!     :cond_1a
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
***************
*** 9980,9986 ****
      .end local v5           #allowedSig:Z
      .end local v11           #level:I
      .end local v16           #perm:Ljava/lang/String;
!     :cond_1a
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
--- 10021,10027 ----
      .end local v5           #allowedSig:Z
      .end local v11           #level:I
      .end local v16           #perm:Ljava/lang/String;
!     :cond_1b
      const-string v19, "PackageManager"
  
      new-instance v20, Ljava/lang/StringBuilder;
***************
*** 10025,10043 ****
  
      .end local v6           #bp:Lcom/android/server/pm/BasePermission;
      .end local v12           #name:Ljava/lang/String;
!     :cond_1b
!     if-nez v7, :cond_1c
  
!     if-eqz p2, :cond_1d
  
!     :cond_1c
      move-object/from16 v0, v17
  
      iget-boolean v0, v0, Lcom/android/server/pm/PackageSetting;->permissionsFixed:Z
  
      move/from16 v19, v0
  
!     if-nez v19, :cond_1d
  
      move-object/from16 v0, v17
  
--- 10066,10084 ----
  
      .end local v6           #bp:Lcom/android/server/pm/BasePermission;
      .end local v12           #name:Ljava/lang/String;
!     :cond_1c
!     if-nez v7, :cond_1d
  
!     if-eqz p2, :cond_1e
  
!     :cond_1d
      move-object/from16 v0, v17
  
      iget-boolean v0, v0, Lcom/android/server/pm/PackageSetting;->permissionsFixed:Z
  
      move/from16 v19, v0
  
!     if-nez v19, :cond_1e
  
      move-object/from16 v0, v17
  
***************
*** 10047,10055 ****
  
      and-int/lit8 v19, v19, 0x1
  
!     if-eqz v19, :cond_1e
  
!     :cond_1d
      move-object/from16 v0, v17
  
      iget v0, v0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I
--- 10088,10096 ----
  
      and-int/lit8 v19, v19, 0x1
  
!     if-eqz v19, :cond_1f
  
!     :cond_1e
      move-object/from16 v0, v17
  
      iget v0, v0, Lcom/android/server/pm/PackageSetting;->pkgFlags:I
***************
*** 10062,10070 ****
  
      move/from16 v19, v0
  
!     if-eqz v19, :cond_1f
  
!     :cond_1e
      const/16 v19, 0x1
  
      move/from16 v0, v19
--- 10103,10111 ----
  
      move/from16 v19, v0
  
!     if-eqz v19, :cond_20
  
!     :cond_1f
      const/16 v19, 0x1
  
      move/from16 v0, v19
***************
*** 10073,10079 ****
  
      iput-boolean v0, v1, Lcom/android/server/pm/PackageSetting;->permissionsFixed:Z
  
!     :cond_1f
      const/16 v19, 0x1
  
      move/from16 v0, v19
--- 10114,10120 ----
  
      iput-boolean v0, v1, Lcom/android/server/pm/PackageSetting;->permissionsFixed:Z
  
!     :cond_20
      const/16 v19, 0x1
  
      move/from16 v0, v19
***************
*** 15470,15475 ****
--- 15511,15521 ----
      .parameter "scanMode"
      .parameter "currentTime"
      .parameter "user"
+     .annotation build Landroid/annotation/OppoHook;
+         level = .enum Landroid/annotation/OppoHook$OppoHookType;->CHANGE_CODE:Landroid/annotation/OppoHook$OppoHookType;
+         note = "wanglan modify for unpacking the native lib for some SysApk whose lib is not under system/lib, add to avoid dex not found exception in eng mode,Jianhua.Lin@Plf.SDK : Add for start OppoResolverActivity instead of ResolverActivity"
+         property = .enum Landroid/annotation/OppoHook$OppoRomType;->ROM:Landroid/annotation/OppoHook$OppoRomType;
+     .end annotation
  
      .prologue
      new-instance v52, Ljava/io/File;
***************
*** 15692,15698 ****
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;
  
!     const-class v10, Lcom/android/internal/app/ResolverActivity;
  
      invoke-virtual {v10}, Ljava/lang/Class;->getName()Ljava/lang/String;
  
--- 15738,15744 ----
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mResolveActivity:Landroid/content/pm/ActivityInfo;
  
!     const-class v10, Lcom/android/internal/app/OppoResolverActivity;
  
      invoke-virtual {v10}, Ljava/lang/Class;->getName()Ljava/lang/String;
  
***************
*** 17451,17457 ****
      .local v53, scanFileTime:J
      and-int/lit8 v3, p3, 0x4
  
!     if-eqz v3, :cond_2a
  
      const/16 v24, 0x1
  
--- 17497,17503 ----
      .local v53, scanFileTime:J
      and-int/lit8 v3, p3, 0x4
  
!     if-eqz v3, :cond_2b
  
      const/16 v24, 0x1
  
***************
*** 17491,17497 ****
  
      move-object/from16 v0, p1
  
!     if-ne v3, v0, :cond_2b
  
      new-instance v20, Ljava/io/File;
  
--- 17537,17543 ----
  
      move-object/from16 v0, p1
  
!     if-ne v3, v0, :cond_2c
  
      new-instance v20, Ljava/io/File;
  
***************
*** 17553,17565 ****
  
      move-result v3
  
!     if-eqz v3, :cond_3a
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3a
  
      invoke-static/range {v34 .. v34}, Lcom/android/internal/content/NativeLibraryHelper;->removeNativeBinariesFromDirLI(Ljava/io/File;)Z
  
--- 17599,17621 ----
  
      move-result v3
  
!     if-eqz v3, :cond_3b
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isUpdatedSystemApp(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3b
! 
!     move-object/from16 v0, p1
! 
!     iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
! 
!     invoke-static {v3}, Lcom/android/server/pm/OppoPackageManagerHelper;->IsForceUnpackNativeLibList(Ljava/lang/String;)Z
! 
!     move-result v3
! 
!     if-nez v3, :cond_3b
  
      invoke-static/range {v34 .. v34}, Lcom/android/internal/content/NativeLibraryHelper;->removeNativeBinariesFromDirLI(Ljava/io/File;)Z
  
***************
*** 17605,17612 ****
  
      and-int/lit8 v3, p3, 0x2
  
!     if-nez v3, :cond_40
  
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
--- 17661,17679 ----
  
      and-int/lit8 v3, p3, 0x2
  
!     if-eqz v3, :cond_2a
! 
!     move-object/from16 v0, p1
! 
!     iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
! 
!     invoke-static {v3}, Lcom/android/server/pm/OppoPackageManagerHelper;->IsPredexOptList(Ljava/lang/String;)Z
  
+     move-result v3
+ 
+     if-eqz v3, :cond_41
+ 
+     :cond_2a
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
***************
*** 17637,17643 ****
  
      and-int/lit16 v3, v0, 0x80
  
!     if-eqz v3, :cond_3f
  
      const/4 v3, 0x1
  
--- 17704,17710 ----
  
      and-int/lit16 v3, v0, 0x80
  
!     if-eqz v3, :cond_40
  
      const/4 v3, 0x1
  
***************
*** 17654,17660 ****
  
      const/4 v4, -0x1
  
!     if-ne v3, v4, :cond_40
  
      const/16 v3, -0xb
  
--- 17721,17727 ----
  
      const/4 v4, -0x1
  
!     if-ne v3, v4, :cond_41
  
      const/16 v3, -0xb
  
***************
*** 17669,17681 ****
      .end local v20           #dataPath:Ljava/io/File;
      .end local v24           #forceDex:Z
      .end local v41           #path:Ljava/lang/String;
!     :cond_2a
      const/16 v24, 0x0
  
      goto/16 :goto_d
  
      .restart local v24       #forceDex:Z
!     :cond_2b
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
--- 17736,17748 ----
      .end local v20           #dataPath:Ljava/io/File;
      .end local v24           #forceDex:Z
      .end local v41           #path:Ljava/lang/String;
!     :cond_2b
      const/16 v24, 0x0
  
      goto/16 :goto_d
  
      .restart local v24       #forceDex:Z
!     :cond_2c
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
***************
*** 17696,17702 ****
  
      move-result v3
  
!     if-eqz v3, :cond_35
  
      const/16 v19, 0x0
  
--- 17763,17769 ----
  
      move-result v3
  
!     if-eqz v3, :cond_36
  
      const/16 v19, 0x0
  
***************
*** 17731,17742 ****
  
      move/from16 v0, v19
  
!     if-eq v0, v3, :cond_32
  
      const/16 v48, 0x0
  
      .local v48, recovered:Z
!     if-nez v19, :cond_2c
  
      move-object/from16 v0, p0
  
--- 17798,17809 ----
  
      move/from16 v0, v19
  
!     if-eq v0, v3, :cond_33
  
      const/16 v48, 0x0
  
      .local v48, recovered:Z
!     if-nez v19, :cond_2d
  
      move-object/from16 v0, p0
  
***************
*** 17761,17767 ****
      move-result v50
  
      .local v50, ret:I
!     if-ltz v50, :cond_2c
  
      const/16 v48, 0x1
  
--- 17828,17834 ----
      move-result v50
  
      .local v50, ret:I
!     if-ltz v50, :cond_2d
  
      const/16 v48, 0x1
  
***************
*** 17812,17831 ****
  
      .end local v32           #msg:Ljava/lang/String;
      .end local v50           #ret:I
!     :cond_2c
!     if-nez v48, :cond_34
  
      and-int/lit8 v3, p2, 0x1
  
!     if-nez v3, :cond_2d
  
      move/from16 v0, p3
  
      and-int/lit16 v3, v0, 0x100
  
!     if-eqz v3, :cond_34
  
!     :cond_2d
      move-object/from16 v0, p0
  
      move-object/from16 v1, v44
--- 17879,17898 ----
  
      .end local v32           #msg:Ljava/lang/String;
      .end local v50           #ret:I
!     :cond_2d
!     if-nez v48, :cond_35
  
      and-int/lit8 v3, p2, 0x1
  
!     if-nez v3, :cond_2e
  
      move/from16 v0, p3
  
      and-int/lit16 v3, v0, 0x100
  
!     if-eqz v3, :cond_35
  
!     :cond_2e
      move-object/from16 v0, p0
  
      move-object/from16 v1, v44
***************
*** 17835,17845 ****
      move-result v50
  
      .restart local v50       #ret:I
!     if-ltz v50, :cond_2f
  
      and-int/lit8 v3, p2, 0x1
  
!     if-eqz v3, :cond_2e
  
      const-string v46, "System package "
  
--- 17902,17912 ----
      move-result v50
  
      .restart local v50       #ret:I
!     if-ltz v50, :cond_30
  
      and-int/lit8 v3, p2, 0x1
  
!     if-eqz v3, :cond_2f
  
      const-string v46, "System package "
  
***************
*** 17928,17934 ****
  
      move/from16 v0, v50
  
!     if-ne v0, v3, :cond_2f
  
      new-instance v3, Ljava/lang/StringBuilder;
  
--- 17995,18001 ----
  
      move/from16 v0, v50
  
!     if-ne v0, v3, :cond_30
  
      new-instance v3, Ljava/lang/StringBuilder;
  
***************
*** 18015,18027 ****
      .end local v22           #e:Llibcore/io/ErrnoException;
      .restart local v48       #recovered:Z
      .restart local v50       #ret:I
!     :cond_2e
      const-string v46, "Third party package "
  
      goto/16 :goto_12
  
!     :cond_2f
!     if-nez v48, :cond_30
  
      const/4 v3, 0x1
  
--- 18082,18094 ----
      .end local v22           #e:Llibcore/io/ErrnoException;
      .restart local v48       #recovered:Z
      .restart local v50       #ret:I
!     :cond_2f
      const-string v46, "Third party package "
  
      goto/16 :goto_12
  
!     :cond_30
!     if-nez v48, :cond_31
  
      const/4 v3, 0x1
  
***************
*** 18030,18037 ****
      iput-boolean v3, v0, Lcom/android/server/pm/PackageManagerService;->mHasSystemUidErrors:Z
  
      .end local v50           #ret:I
!     :cond_30
!     if-nez v48, :cond_32
  
      move-object/from16 v0, p1
  
--- 18097,18104 ----
      iput-boolean v3, v0, Lcom/android/server/pm/PackageManagerService;->mHasSystemUidErrors:Z
  
      .end local v50           #ret:I
!     :cond_31
!     if-nez v48, :cond_33
  
      move-object/from16 v0, p1
  
***************
*** 18177,18183 ****
  
      iget-boolean v3, v0, Lcom/android/server/pm/PackageSetting;->uidError:Z
  
!     if-nez v3, :cond_31
  
      const/4 v3, 0x6
  
--- 18244,18250 ----
  
      iget-boolean v3, v0, Lcom/android/server/pm/PackageSetting;->uidError:Z
  
!     if-nez v3, :cond_32
  
      const/4 v3, 0x6
  
***************
*** 18185,18198 ****
  
      invoke-static {v3, v0}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V
  
!     :cond_31
      monitor-exit v4
      :try_end_6
      .catchall {:try_start_6 .. :try_end_6} :catchall_2
  
      .end local v32           #msg:Ljava/lang/String;
      .end local v48           #recovered:Z
!     :cond_32
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
--- 18252,18265 ----
  
      invoke-static {v3, v0}, Lcom/android/server/pm/PackageManagerService;->reportSettingsProblem(ILjava/lang/String;)V
  
!     :cond_32
      monitor-exit v4
      :try_end_6
      .catchall {:try_start_6 .. :try_end_6} :catchall_2
  
      .end local v32           #msg:Ljava/lang/String;
      .end local v48           #recovered:Z
!     :cond_33
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
***************
*** 18211,18217 ****
  
      iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;
  
!     if-nez v3, :cond_33
  
      move-object/from16 v0, p1
  
--- 18278,18284 ----
  
      iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->nativeLibraryDir:Ljava/lang/String;
  
!     if-nez v3, :cond_34
  
      move-object/from16 v0, p1
  
***************
*** 18219,18231 ****
  
      iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->dataDir:Ljava/lang/String;
  
!     if-eqz v3, :cond_33
  
      move-object/from16 v0, v45
  
      iget-object v3, v0, Lcom/android/server/pm/PackageSetting;->nativeLibraryPathString:Ljava/lang/String;
  
!     if-nez v3, :cond_39
  
      move-object/from16 v0, p0
  
--- 18286,18298 ----
  
      iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->dataDir:Ljava/lang/String;
  
!     if-eqz v3, :cond_34
  
      move-object/from16 v0, v45
  
      iget-object v3, v0, Lcom/android/server/pm/PackageSetting;->nativeLibraryPathString:Ljava/lang/String;
  
!     if-nez v3, :cond_3a
  
      move-object/from16 v0, p0
  
***************
*** 18235,18241 ****
  
      invoke-direct {v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->setInternalAppNativeLibraryPath(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;)V
  
!     :cond_33
      :goto_14
      move/from16 v0, v57
  
--- 18302,18308 ----
  
      invoke-direct {v0, v1, v2}, Lcom/android/server/pm/PackageManagerService;->setInternalAppNativeLibraryPath(Landroid/content/pm/PackageParser$Package;Lcom/android/server/pm/PackageSetting;)V
  
!     :cond_34
      :goto_14
      move/from16 v0, v57
  
***************
*** 18247,18254 ****
  
      .restart local v19       #currentUid:I
      .restart local v48       #recovered:Z
!     :cond_34
!     if-nez v48, :cond_30
  
      const/16 v3, -0x18
  
--- 18314,18321 ----
  
      .restart local v19       #currentUid:I
      .restart local v48       #recovered:Z
!     :cond_35
!     if-nez v48, :cond_31
  
      const/16 v3, -0x18
  
***************
*** 18274,18287 ****
      .end local v19           #currentUid:I
      .end local v32           #msg:Ljava/lang/String;
      .end local v48           #recovered:Z
!     :cond_35
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_36
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_36
  
      const-string v3, "PackageManager"
  
--- 18341,18354 ----
      .end local v19           #currentUid:I
      .end local v32           #msg:Ljava/lang/String;
      .end local v48           #recovered:Z
!     :cond_36
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_37
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_37
  
      const-string v3, "PackageManager"
  
***************
*** 18307,18313 ****
  
      invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_36
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
--- 18374,18380 ----
  
      invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_37
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
***************
*** 18323,18329 ****
      move-result v50
  
      .restart local v50       #ret:I
!     if-gez v50, :cond_37
  
      const/4 v3, -0x4
  
--- 18390,18396 ----
      move-result v50
  
      .restart local v50       #ret:I
!     if-gez v50, :cond_38
  
      const/4 v3, -0x4
  
***************
*** 18335,18346 ****
  
      goto/16 :goto_0
  
!     :cond_37
      invoke-virtual/range {v20 .. v20}, Ljava/io/File;->exists()Z
  
      move-result v3
  
!     if-eqz v3, :cond_38
  
      move-object/from16 v0, p1
  
--- 18402,18413 ----
  
      goto/16 :goto_0
  
!     :cond_38
      invoke-virtual/range {v20 .. v20}, Ljava/io/File;->exists()Z
  
      move-result v3
  
!     if-eqz v3, :cond_39
  
      move-object/from16 v0, p1
  
***************
*** 18354,18360 ****
  
      goto/16 :goto_13
  
!     :cond_38
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
--- 18421,18427 ----
  
      goto/16 :goto_13
  
!     :cond_39
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
***************
*** 18390,18396 ****
      goto/16 :goto_13
  
      .end local v50           #ret:I
!     :cond_39
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
--- 18457,18463 ----
      goto/16 :goto_13
  
      .end local v50           #ret:I
!     :cond_3a
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->applicationInfo:Landroid/content/pm/ApplicationInfo;
***************
*** 18407,18425 ****
      .restart local v21       #dataPathString:Ljava/lang/String;
      .restart local v34       #nativeLibraryDir:Ljava/io/File;
      .restart local v41       #path:Ljava/lang/String;
!     :cond_3a
      :try_start_8
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isForwardLocked(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3c
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3c
  
      invoke-virtual/range {v34 .. v34}, Ljava/io/File;->getPath()Ljava/lang/String;
  
--- 18474,18492 ----
      .restart local v21       #dataPathString:Ljava/lang/String;
      .restart local v34       #nativeLibraryDir:Ljava/io/File;
      .restart local v41       #path:Ljava/lang/String;
!     :cond_3b
      :try_start_8
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isForwardLocked(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3d
  
      invoke-static/range {p1 .. p1}, Lcom/android/server/pm/PackageManagerService;->isExternal(Landroid/content/pm/PackageParser$Package;)Z
  
      move-result v3
  
!     if-nez v3, :cond_3d
  
      invoke-virtual/range {v34 .. v34}, Ljava/io/File;->getPath()Ljava/lang/String;
  
***************
*** 18431,18437 ****
  
      move-result v3
  
!     if-eqz v3, :cond_3b
  
      move-object/from16 v0, p0
  
--- 18498,18504 ----
  
      move-result v3
  
!     if-eqz v3, :cond_3c
  
      move-object/from16 v0, p0
  
***************
*** 18457,18463 ****
      .catch Ljava/io/IOException; {:try_start_8 .. :try_end_8} :catch_2
  
      .restart local v34       #nativeLibraryDir:Ljava/io/File;
!     :cond_3b
      :try_start_9
      move-object/from16 v0, v52
  
--- 18524,18530 ----
      .catch Ljava/io/IOException; {:try_start_8 .. :try_end_8} :catch_2
  
      .restart local v34       #nativeLibraryDir:Ljava/io/File;
!     :cond_3c
      :try_start_9
      move-object/from16 v0, v52
  
***************
*** 18469,18475 ****
  
      const/4 v4, 0x1
  
!     if-eq v3, v4, :cond_3c
  
      const-string v3, "PackageManager"
  
--- 18536,18542 ----
  
      const/4 v4, 0x1
  
!     if-eq v3, v4, :cond_3d
  
      const-string v3, "PackageManager"
  
***************
*** 18513,18519 ****
      goto/16 :goto_0
  
      .end local v22           #e:Ljava/io/IOException;
!     :cond_3c
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
--- 18580,18586 ----
      goto/16 :goto_0
  
      .end local v22           #e:Ljava/io/IOException;
!     :cond_3d
      const-string v3, "PackageManager"
  
      new-instance v4, Ljava/lang/StringBuilder;
***************
*** 18572,18578 ****
  
      move/from16 v1, v31
  
!     if-ge v0, v1, :cond_3e
  
      aget v58, v16, v26
  
--- 18639,18645 ----
  
      move/from16 v1, v31
  
!     if-ge v0, v1, :cond_3f
  
      aget v58, v16, v26
  
***************
*** 18597,18603 ****
  
      move-result v3
  
!     if-gez v3, :cond_3d
  
      const-string v3, "PackageManager"
  
--- 18664,18670 ----
  
      move-result v3
  
!     if-gez v3, :cond_3e
  
      const-string v3, "PackageManager"
  
***************
*** 18643,18655 ****
  
      goto/16 :goto_0
  
!     :cond_3d
      add-int/lit8 v26, v26, 0x1
  
      goto :goto_15
  
      .end local v58           #userId:I
!     :cond_3e
      monitor-exit v4
  
      goto/16 :goto_f
--- 18710,18722 ----
  
      goto/16 :goto_0
  
!     :cond_3e
      add-int/lit8 v26, v26, 0x1
  
      goto :goto_15
  
      .end local v58           #userId:I
!     :cond_3f
      monitor-exit v4
  
      goto/16 :goto_f
***************
*** 18705,18721 ****
      goto/16 :goto_f
  
      .end local v27           #ioe:Ljava/io/IOException;
!     :cond_3f
      const/4 v3, 0x0
  
      goto/16 :goto_10
  
!     :cond_40
      move-object/from16 v0, p0
  
      iget-boolean v3, v0, Lcom/android/server/pm/PackageManagerService;->mFactoryTest:Z
  
!     if-eqz v3, :cond_41
  
      move-object/from16 v0, p1
  
--- 18772,18788 ----
      goto/16 :goto_f
  
      .end local v27           #ioe:Ljava/io/IOException;
!     :cond_40
      const/4 v3, 0x0
  
      goto/16 :goto_10
  
!     :cond_41
      move-object/from16 v0, p0
  
      iget-boolean v3, v0, Lcom/android/server/pm/PackageManagerService;->mFactoryTest:Z
  
!     if-eqz v3, :cond_42
  
      move-object/from16 v0, p1
  
***************
*** 18727,18733 ****
  
      move-result v3
  
!     if-eqz v3, :cond_41
  
      move-object/from16 v0, p1
  
--- 18794,18800 ----
  
      move-result v3
  
!     if-eqz v3, :cond_42
  
      move-object/from16 v0, p1
  
***************
*** 18739,18748 ****
  
      iput v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
  
!     :cond_41
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_42
  
      move-object/from16 v0, p1
  
--- 18806,18815 ----
  
      iput v4, v3, Landroid/content/pm/ApplicationInfo;->flags:I
  
!     :cond_42
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_43
  
      move-object/from16 v0, p1
  
***************
*** 18760,18766 ****
  
      invoke-direct {v0, v3, v4}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;I)V
  
!     :cond_42
      move-object/from16 v0, p0
  
      iget-object v4, v0, Lcom/android/server/pm/PackageManagerService;->mPackages:Ljava/util/HashMap;
--- 18827,18833 ----
  
      invoke-direct {v0, v3, v4}, Lcom/android/server/pm/PackageManagerService;->killApplication(Ljava/lang/String;I)V
  
!     :cond_43
      move-object/from16 v0, p0
  
      iget-object v4, v0, Lcom/android/server/pm/PackageManagerService;->mPackages:Ljava/util/HashMap;
***************
*** 18769,18775 ****
  
      and-int/lit8 v3, p3, 0x1
  
!     if-eqz v3, :cond_43
  
      :try_start_d
      move-object/from16 v0, p0
--- 18836,18842 ----
  
      and-int/lit8 v3, p3, 0x1
  
!     if-eqz v3, :cond_44
  
      :try_start_d
      move-object/from16 v0, p0
***************
*** 18784,18790 ****
  
      invoke-virtual {v3, v10, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
!     :cond_43
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
--- 18851,18857 ----
  
      invoke-virtual {v3, v10, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
!     :cond_44
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
***************
*** 18820,18832 ****
      move-result-object v29
  
      .local v29, iter:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/content/pm/PackageCleanItem;>;"
!     :cond_44
      :goto_16
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->hasNext()Z
  
      move-result v3
  
!     if-eqz v3, :cond_45
  
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->next()Ljava/lang/Object;
  
--- 18887,18899 ----
      move-result-object v29
  
      .local v29, iter:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/content/pm/PackageCleanItem;>;"
!     :cond_45
      :goto_16
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->hasNext()Z
  
      move-result v3
  
!     if-eqz v3, :cond_46
  
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->next()Ljava/lang/Object;
  
***************
*** 18845,18851 ****
  
      move-result v3
  
!     if-eqz v3, :cond_44
  
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->remove()V
  
--- 18912,18918 ----
  
      move-result v3
  
!     if-eqz v3, :cond_45
  
      invoke-interface/range {v29 .. v29}, Ljava/util/Iterator;->remove()V
  
***************
*** 18863,18874 ****
      throw v3
  
      .restart local v29       #iter:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/content/pm/PackageCleanItem;>;"
!     :cond_45
      move/from16 v0, p2
  
      and-int/lit16 v3, v0, 0x100
  
!     if-eqz v3, :cond_46
  
      :try_start_e
      move-object/from16 v0, p0
--- 18930,18941 ----
      throw v3
  
      .restart local v29       #iter:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/content/pm/PackageCleanItem;>;"
!     :cond_46
      move/from16 v0, p2
  
      and-int/lit16 v3, v0, 0x100
  
!     if-eqz v3, :cond_47
  
      :try_start_e
      move-object/from16 v0, p0
***************
*** 18883,18894 ****
  
      invoke-virtual {v3, v10, v11}, Lcom/android/server/pm/VendorSettings;->insertPackage(Ljava/lang/String;Z)V
  
!     :cond_46
      const-wide/16 v10, 0x0
  
      cmp-long v3, p4, v10
  
!     if-eqz v3, :cond_4a
  
      move-object/from16 v0, v45
  
--- 18950,18961 ----
  
      invoke-virtual {v3, v10, v11}, Lcom/android/server/pm/VendorSettings;->insertPackage(Ljava/lang/String;Z)V
  
!     :cond_47
      const-wide/16 v10, 0x0
  
      cmp-long v3, p4, v10
  
!     if-eqz v3, :cond_4b
  
      move-object/from16 v0, v45
  
***************
*** 18898,18904 ****
  
      cmp-long v3, v10, v12
  
!     if-nez v3, :cond_49
  
      move-wide/from16 v0, p4
  
--- 18965,18971 ----
  
      cmp-long v3, v10, v12
  
!     if-nez v3, :cond_4a
  
      move-wide/from16 v0, p4
  
***************
*** 18912,18918 ****
  
      iput-wide v0, v2, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J
  
!     :cond_47
      :goto_17
      move-object/from16 v0, p1
  
--- 18979,18985 ----
  
      iput-wide v0, v2, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J
  
!     :cond_48
      :goto_17
      move-object/from16 v0, p1
  
***************
*** 18932,18938 ****
      :goto_18
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_53
  
      move-object/from16 v0, p1
  
--- 18999,19005 ----
      :goto_18
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_54
  
      move-object/from16 v0, p1
  
***************
*** 19015,19021 ****
  
      iget-object v3, v3, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;
  
!     if-eqz v3, :cond_50
  
      move-object/from16 v0, v39
  
--- 19082,19088 ----
  
      iget-object v3, v3, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;
  
!     if-eqz v3, :cond_51
  
      move-object/from16 v0, v39
  
***************
*** 19052,19070 ****
  
      move/from16 v0, v30
  
!     if-ge v0, v3, :cond_4f
  
      const/4 v3, 0x1
  
      move/from16 v0, v30
  
!     if-ne v0, v3, :cond_7b
  
      move-object/from16 v0, v40
  
      iget-boolean v3, v0, Landroid/content/pm/PackageParser$Provider;->syncable:Z
  
!     if-eqz v3, :cond_7b
  
      new-instance v39, Landroid/content/pm/PackageParser$Provider;
  
--- 19119,19137 ----
  
      move/from16 v0, v30
  
!     if-ge v0, v3, :cond_50
  
      const/4 v3, 0x1
  
      move/from16 v0, v30
  
!     if-ne v0, v3, :cond_7c
  
      move-object/from16 v0, v40
  
      iget-boolean v3, v0, Landroid/content/pm/PackageParser$Provider;->syncable:Z
  
!     if-eqz v3, :cond_7c
  
      new-instance v39, Landroid/content/pm/PackageParser$Provider;
  
***************
*** 19089,19095 ****
  
      move-result v3
  
!     if-nez v3, :cond_4d
  
      move-object/from16 v0, p0
  
--- 19156,19162 ----
  
      move-result v3
  
!     if-nez v3, :cond_4e
  
      move-object/from16 v0, p0
  
***************
*** 19107,19113 ****
  
      iget-object v3, v3, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;
  
!     if-nez v3, :cond_4c
  
      move-object/from16 v0, v39
  
--- 19174,19180 ----
  
      iget-object v3, v3, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;
  
!     if-nez v3, :cond_4d
  
      move-object/from16 v0, v39
  
***************
*** 19120,19130 ****
      :goto_1b
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_48
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_48
  
      const-string v3, "PackageManager"
  
--- 19187,19197 ----
      :goto_1b
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_49
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_49
  
      const-string v3, "PackageManager"
  
***************
*** 19182,19188 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_48
      :goto_1c
      add-int/lit8 v30, v30, 0x1
  
--- 19249,19255 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_49
      :goto_1c
      add-int/lit8 v30, v30, 0x1
  
***************
*** 19198,19207 ****
      .end local v33           #names:[Ljava/lang/String;
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
      .end local v47           #r:Ljava/lang/StringBuilder;
!     :cond_49
      and-int/lit8 v3, p3, 0x40
  
!     if-eqz v3, :cond_47
  
      move-wide/from16 v0, p4
  
--- 19265,19274 ----
      .end local v33           #names:[Ljava/lang/String;
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
      .end local v47           #r:Ljava/lang/StringBuilder;
!     :cond_4a
      and-int/lit8 v3, p3, 0x40
  
!     if-eqz v3, :cond_48
  
      move-wide/from16 v0, p4
  
***************
*** 19211,19217 ****
  
      goto/16 :goto_17
  
!     :cond_4a
      move-object/from16 v0, v45
  
      iget-wide v10, v0, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J
--- 19278,19284 ----
  
      goto/16 :goto_17
  
!     :cond_4b
      move-object/from16 v0, v45
  
      iget-wide v10, v0, Lcom/android/server/pm/PackageSetting;->firstInstallTime:J
***************
*** 19220,19226 ****
  
      cmp-long v3, v10, v12
  
!     if-nez v3, :cond_4b
  
      move-wide/from16 v0, v53
  
--- 19287,19293 ----
  
      cmp-long v3, v10, v12
  
!     if-nez v3, :cond_4c
  
      move-wide/from16 v0, v53
  
***************
*** 19236,19245 ****
  
      goto/16 :goto_17
  
!     :cond_4b
      and-int/lit8 v3, p2, 0x40
  
!     if-eqz v3, :cond_47
  
      move-object/from16 v0, v45
  
--- 19303,19312 ----
  
      goto/16 :goto_17
  
!     :cond_4c
      and-int/lit8 v3, p2, 0x40
  
!     if-eqz v3, :cond_48
  
      move-object/from16 v0, v45
  
***************
*** 19247,19253 ****
  
      cmp-long v3, v53, v10
  
!     if-eqz v3, :cond_47
  
      move-wide/from16 v0, v53
  
--- 19314,19320 ----
  
      cmp-long v3, v53, v10
  
!     if-eqz v3, :cond_48
  
      move-wide/from16 v0, v53
  
***************
*** 19263,19269 ****
      .restart local v33       #names:[Ljava/lang/String;
      .restart local v39       #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v47       #r:Ljava/lang/StringBuilder;
!     :cond_4c
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;
--- 19330,19336 ----
      .restart local v33       #names:[Ljava/lang/String;
      .restart local v39       #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v47       #r:Ljava/lang/StringBuilder;
!     :cond_4d
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Provider;->info:Landroid/content/pm/ProviderInfo;
***************
*** 19302,19308 ****
  
      goto/16 :goto_1b
  
!     :cond_4d
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mProviders:Ljava/util/HashMap;
--- 19369,19375 ----
  
      goto/16 :goto_1b
  
!     :cond_4e
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mProviders:Ljava/util/HashMap;
***************
*** 19356,19368 ****
  
      move-result-object v11
  
!     if-eqz v38, :cond_4e
  
      invoke-virtual/range {v38 .. v38}, Landroid/content/pm/PackageParser$Provider;->getComponentName()Landroid/content/ComponentName;
  
      move-result-object v3
  
!     if-eqz v3, :cond_4e
  
      invoke-virtual/range {v38 .. v38}, Landroid/content/pm/PackageParser$Provider;->getComponentName()Landroid/content/ComponentName;
  
--- 19423,19435 ----
  
      move-result-object v11
  
!     if-eqz v38, :cond_4f
  
      invoke-virtual/range {v38 .. v38}, Landroid/content/pm/PackageParser$Provider;->getComponentName()Landroid/content/ComponentName;
  
      move-result-object v3
  
!     if-eqz v3, :cond_4f
  
      invoke-virtual/range {v38 .. v38}, Landroid/content/pm/PackageParser$Provider;->getComponentName()Landroid/content/ComponentName;
  
***************
*** 19385,19391 ****
  
      goto/16 :goto_1c
  
!     :cond_4e
      const-string v3, "?"
  
      goto :goto_1d
--- 19452,19458 ----
  
      goto/16 :goto_1c
  
!     :cond_4f
      const-string v3, "?"
  
      goto :goto_1d
***************
*** 19393,19411 ****
      .end local v38           #other:Landroid/content/pm/PackageParser$Provider;
      .end local v39           #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v40       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_4f
      move-object/from16 v39, v40
  
      .end local v30           #j:I
      .end local v33           #names:[Ljava/lang/String;
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v39       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_50
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_51
  
!     if-nez v47, :cond_52
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 19460,19478 ----
      .end local v38           #other:Landroid/content/pm/PackageParser$Provider;
      .end local v39           #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v40       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_50
      move-object/from16 v39, v40
  
      .end local v30           #j:I
      .end local v33           #names:[Ljava/lang/String;
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
      .restart local v39       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_51
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_52
  
!     if-nez v47, :cond_53
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 19428,19439 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_51
      add-int/lit8 v25, v25, 0x1
  
      goto/16 :goto_18
  
!     :cond_52
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 19495,19506 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_52
      add-int/lit8 v25, v25, 0x1
  
      goto/16 :goto_18
  
!     :cond_53
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 19443,19454 ****
      goto :goto_1e
  
      .end local v39           #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_53
!     if-eqz v47, :cond_54
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_54
  
      const-string v3, "PackageManager"
  
--- 19510,19521 ----
      goto :goto_1e
  
      .end local v39           #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_54
!     if-eqz v47, :cond_55
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_55
  
      const-string v3, "PackageManager"
  
***************
*** 19474,19480 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_54
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;
--- 19541,19547 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_55
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->services:Ljava/util/ArrayList;
***************
*** 19490,19496 ****
      :goto_1f
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_57
  
      move-object/from16 v0, p1
  
--- 19557,19563 ----
      :goto_1f
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_58
  
      move-object/from16 v0, p1
  
***************
*** 19543,19551 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_55
  
!     if-nez v47, :cond_56
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 19610,19618 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_56
  
!     if-nez v47, :cond_57
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 19568,19579 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_55
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_1f
  
!     :cond_56
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 19635,19646 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_56
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_1f
  
!     :cond_57
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 19583,19594 ****
      goto :goto_20
  
      .end local v51           #s:Landroid/content/pm/PackageParser$Service;
!     :cond_57
!     if-eqz v47, :cond_58
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_58
  
      const-string v3, "PackageManager"
  
--- 19650,19661 ----
      goto :goto_20
  
      .end local v51           #s:Landroid/content/pm/PackageParser$Service;
!     :cond_58
!     if-eqz v47, :cond_59
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_59
  
      const-string v3, "PackageManager"
  
***************
*** 19614,19620 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_58
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;
--- 19681,19687 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_59
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->receivers:Ljava/util/ArrayList;
***************
*** 19630,19636 ****
      :goto_21
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_5b
  
      move-object/from16 v0, p1
  
--- 19697,19703 ----
      :goto_21
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_5c
  
      move-object/from16 v0, p1
  
***************
*** 19679,19687 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_59
  
!     if-nez v47, :cond_5a
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 19746,19754 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_5a
  
!     if-nez v47, :cond_5b
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 19702,19713 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_59
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_21
  
!     :cond_5a
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 19769,19780 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_5a
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_21
  
!     :cond_5b
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 19717,19728 ****
      goto :goto_22
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Activity;
!     :cond_5b
!     if-eqz v47, :cond_5c
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_5c
  
      const-string v3, "PackageManager"
  
--- 19784,19795 ----
      goto :goto_22
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Activity;
!     :cond_5c
!     if-eqz v47, :cond_5d
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_5d
  
      const-string v3, "PackageManager"
  
***************
*** 19748,19754 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_5c
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;
--- 19815,19821 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_5d
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->activities:Ljava/util/ArrayList;
***************
*** 19764,19770 ****
      :goto_23
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_5f
  
      move-object/from16 v0, p1
  
--- 19831,19837 ----
      :goto_23
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_60
  
      move-object/from16 v0, p1
  
***************
*** 19813,19821 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_5d
  
!     if-nez v47, :cond_5e
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 19880,19888 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_5e
  
!     if-nez v47, :cond_5f
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 19836,19847 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_5d
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_23
  
!     :cond_5e
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 19903,19914 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_5e
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_23
  
!     :cond_5f
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 19851,19862 ****
      goto :goto_24
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Activity;
!     :cond_5f
!     if-eqz v47, :cond_60
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_60
  
      const-string v3, "PackageManager"
  
--- 19918,19929 ----
      goto :goto_24
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Activity;
!     :cond_60
!     if-eqz v47, :cond_61
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_61
  
      const-string v3, "PackageManager"
  
***************
*** 19882,19888 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_60
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;
--- 19949,19955 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_61
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->permissionGroups:Ljava/util/ArrayList;
***************
*** 19898,19904 ****
      :goto_25
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_65
  
      move-object/from16 v0, p1
  
--- 19965,19971 ----
      :goto_25
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_66
  
      move-object/from16 v0, p1
  
***************
*** 19930,19936 ****
      check-cast v18, Landroid/content/pm/PackageParser$PermissionGroup;
  
      .local v18, cur:Landroid/content/pm/PackageParser$PermissionGroup;
!     if-nez v18, :cond_63
  
      move-object/from16 v0, p0
  
--- 19997,20003 ----
      check-cast v18, Landroid/content/pm/PackageParser$PermissionGroup;
  
      .local v18, cur:Landroid/content/pm/PackageParser$PermissionGroup;
!     if-nez v18, :cond_64
  
      move-object/from16 v0, p0
  
***************
*** 19948,19956 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_61
  
!     if-nez v47, :cond_62
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 20015,20023 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_62
  
!     if-nez v47, :cond_63
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 19973,19985 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_61
      :goto_27
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_25
  
!     :cond_62
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 20040,20052 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_62
      :goto_27
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_25
  
!     :cond_63
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 19988,19994 ****
  
      goto :goto_26
  
!     :cond_63
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
--- 20055,20061 ----
  
      goto :goto_26
  
!     :cond_64
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
***************
*** 20051,20059 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_61
  
!     if-nez v47, :cond_64
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 20118,20126 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_62
  
!     if-nez v47, :cond_65
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 20084,20090 ****
  
      goto :goto_27
  
!     :cond_64
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 20151,20157 ----
  
      goto :goto_27
  
!     :cond_65
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 20095,20106 ****
  
      .end local v18           #cur:Landroid/content/pm/PackageParser$PermissionGroup;
      .end local v43           #pg:Landroid/content/pm/PackageParser$PermissionGroup;
!     :cond_65
!     if-eqz v47, :cond_66
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_66
  
      const-string v3, "PackageManager"
  
--- 20162,20173 ----
  
      .end local v18           #cur:Landroid/content/pm/PackageParser$PermissionGroup;
      .end local v43           #pg:Landroid/content/pm/PackageParser$PermissionGroup;
!     :cond_66
!     if-eqz v47, :cond_67
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_67
  
      const-string v3, "PackageManager"
  
***************
*** 20126,20132 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_66
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;
--- 20193,20199 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_67
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->permissions:Ljava/util/ArrayList;
***************
*** 20142,20148 ****
      :goto_29
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_74
  
      move-object/from16 v0, p1
  
--- 20209,20215 ----
      :goto_29
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_75
  
      move-object/from16 v0, p1
  
***************
*** 20161,20167 ****
  
      iget-boolean v3, v0, Landroid/content/pm/PackageParser$Permission;->tree:Z
  
!     if-eqz v3, :cond_6d
  
      move-object/from16 v0, p0
  
--- 20228,20234 ----
  
      iget-boolean v3, v0, Landroid/content/pm/PackageParser$Permission;->tree:Z
  
!     if-eqz v3, :cond_6e
  
      move-object/from16 v0, p0
  
***************
*** 20199,20213 ****
  
      iget-object v3, v3, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;
  
!     if-eqz v3, :cond_67
  
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->group:Landroid/content/pm/PackageParser$PermissionGroup;
  
!     if-eqz v3, :cond_73
  
!     :cond_67
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;
--- 20266,20280 ----
  
      iget-object v3, v3, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;
  
!     if-eqz v3, :cond_68
  
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->group:Landroid/content/pm/PackageParser$PermissionGroup;
  
!     if-eqz v3, :cond_74
  
!     :cond_68
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;
***************
*** 20223,20229 ****
      check-cast v17, Lcom/android/server/pm/BasePermission;
  
      .local v17, bp:Lcom/android/server/pm/BasePermission;
!     if-nez v17, :cond_68
  
      new-instance v17, Lcom/android/server/pm/BasePermission;
  
--- 20290,20296 ----
      check-cast v17, Lcom/android/server/pm/BasePermission;
  
      .local v17, bp:Lcom/android/server/pm/BasePermission;
!     if-nez v17, :cond_69
  
      new-instance v17, Lcom/android/server/pm/BasePermission;
  
***************
*** 20259,20276 ****
  
      invoke-virtual {v0, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
!     :cond_68
      move-object/from16 v0, v17
  
      iget-object v3, v0, Lcom/android/server/pm/BasePermission;->perm:Landroid/content/pm/PackageParser$Permission;
  
!     if-nez v3, :cond_71
  
      move-object/from16 v0, v17
  
      iget-object v3, v0, Lcom/android/server/pm/BasePermission;->sourcePackage:Ljava/lang/String;
  
!     if-eqz v3, :cond_69
  
      move-object/from16 v0, v17
  
--- 20326,20343 ----
  
      invoke-virtual {v0, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
  
!     :cond_69
      move-object/from16 v0, v17
  
      iget-object v3, v0, Lcom/android/server/pm/BasePermission;->perm:Landroid/content/pm/PackageParser$Permission;
  
!     if-nez v3, :cond_72
  
      move-object/from16 v0, v17
  
      iget-object v3, v0, Lcom/android/server/pm/BasePermission;->sourcePackage:Ljava/lang/String;
  
!     if-eqz v3, :cond_6a
  
      move-object/from16 v0, v17
  
***************
*** 20286,20294 ****
  
      move-result v3
  
!     if-eqz v3, :cond_70
  
!     :cond_69
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;
--- 20353,20361 ----
  
      move-result v3
  
!     if-eqz v3, :cond_71
  
!     :cond_6a
      move-object/from16 v0, v39
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Permission;->info:Landroid/content/pm/PermissionInfo;
***************
*** 20302,20308 ****
      move-result-object v56
  
      .local v56, tree:Lcom/android/server/pm/BasePermission;
!     if-eqz v56, :cond_6a
  
      move-object/from16 v0, v56
  
--- 20369,20375 ----
      move-result-object v56
  
      .local v56, tree:Lcom/android/server/pm/BasePermission;
!     if-eqz v56, :cond_6b
  
      move-object/from16 v0, v56
  
***************
*** 20318,20326 ****
  
      move-result v3
  
!     if-eqz v3, :cond_6f
  
!     :cond_6a
      move-object/from16 v0, v45
  
      move-object/from16 v1, v17
--- 20385,20393 ----
  
      move-result v3
  
!     if-eqz v3, :cond_70
  
!     :cond_6b
      move-object/from16 v0, v45
  
      move-object/from16 v1, v17
***************
*** 20345,20353 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_6b
  
!     if-nez v47, :cond_6e
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 20412,20420 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_6c
  
!     if-nez v47, :cond_6f
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 20371,20377 ****
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
      .end local v56           #tree:Lcom/android/server/pm/BasePermission;
!     :cond_6b
      :goto_2c
      move-object/from16 v0, v17
  
--- 20438,20444 ----
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
      .end local v56           #tree:Lcom/android/server/pm/BasePermission;
!     :cond_6c
      :goto_2c
      move-object/from16 v0, v17
  
***************
*** 20379,20385 ****
  
      move-object/from16 v0, v39
  
!     if-ne v3, v0, :cond_6c
  
      move-object/from16 v0, v39
  
--- 20446,20452 ----
  
      move-object/from16 v0, v39
  
!     if-ne v3, v0, :cond_6d
  
      move-object/from16 v0, v39
  
***************
*** 20392,20405 ****
      iput v3, v0, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
      .end local v17           #bp:Lcom/android/server/pm/BasePermission;
!     :cond_6c
      :goto_2d
      add-int/lit8 v25, v25, 0x1
  
      goto/16 :goto_29
  
      .end local v42           #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
!     :cond_6d
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
--- 20459,20472 ----
      iput v3, v0, Lcom/android/server/pm/BasePermission;->protectionLevel:I
  
      .end local v17           #bp:Lcom/android/server/pm/BasePermission;
!     :cond_6d
      :goto_2d
      add-int/lit8 v25, v25, 0x1
  
      goto/16 :goto_29
  
      .end local v42           #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
!     :cond_6e
      move-object/from16 v0, p0
  
      iget-object v3, v0, Lcom/android/server/pm/PackageManagerService;->mSettings:Lcom/android/server/pm/Settings;
***************
*** 20413,20419 ****
      .restart local v17       #bp:Lcom/android/server/pm/BasePermission;
      .restart local v42       #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
      .restart local v56       #tree:Lcom/android/server/pm/BasePermission;
!     :cond_6e
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 20480,20486 ----
      .restart local v17       #bp:Lcom/android/server/pm/BasePermission;
      .restart local v42       #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
      .restart local v56       #tree:Lcom/android/server/pm/BasePermission;
!     :cond_6f
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 20422,20428 ****
  
      goto :goto_2b
  
!     :cond_6f
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
--- 20489,20495 ----
  
      goto :goto_2b
  
!     :cond_70
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
***************
*** 20498,20504 ****
      goto :goto_2c
  
      .end local v56           #tree:Lcom/android/server/pm/BasePermission;
!     :cond_70
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
--- 20565,20571 ----
      goto :goto_2c
  
      .end local v56           #tree:Lcom/android/server/pm/BasePermission;
!     :cond_71
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
***************
*** 20559,20570 ****
  
      goto/16 :goto_2c
  
!     :cond_71
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_6b
  
!     if-nez v47, :cond_72
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 20626,20637 ----
  
      goto/16 :goto_2c
  
!     :cond_72
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_6c
  
!     if-nez v47, :cond_73
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 20595,20601 ****
  
      goto/16 :goto_2c
  
!     :cond_72
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 20662,20668 ----
  
      goto/16 :goto_2c
  
!     :cond_73
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 20605,20611 ****
      goto :goto_2e
  
      .end local v17           #bp:Lcom/android/server/pm/BasePermission;
!     :cond_73
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
--- 20672,20678 ----
      goto :goto_2e
  
      .end local v17           #bp:Lcom/android/server/pm/BasePermission;
!     :cond_74
      const-string v3, "PackageManager"
  
      new-instance v10, Ljava/lang/StringBuilder;
***************
*** 20668,20679 ****
  
      .end local v39           #p:Landroid/content/pm/PackageParser$Permission;
      .end local v42           #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
!     :cond_74
!     if-eqz v47, :cond_75
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_75
  
      const-string v3, "PackageManager"
  
--- 20735,20746 ----
  
      .end local v39           #p:Landroid/content/pm/PackageParser$Permission;
      .end local v42           #permissionMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/android/server/pm/BasePermission;>;"
!     :cond_75
!     if-eqz v47, :cond_76
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_76
  
      const-string v3, "PackageManager"
  
***************
*** 20699,20705 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_75
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;
--- 20766,20772 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_76
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->instrumentation:Ljava/util/ArrayList;
***************
*** 20715,20721 ****
      :goto_2f
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_78
  
      move-object/from16 v0, p1
  
--- 20782,20788 ----
      :goto_2f
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_79
  
      move-object/from16 v0, p1
  
***************
*** 20792,20800 ****
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_76
  
!     if-nez v47, :cond_77
  
      new-instance v47, Ljava/lang/StringBuilder;
  
--- 20859,20867 ----
  
      and-int/lit8 v3, p2, 0x2
  
!     if-eqz v3, :cond_77
  
!     if-nez v47, :cond_78
  
      new-instance v47, Ljava/lang/StringBuilder;
  
***************
*** 20815,20826 ****
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_76
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_2f
  
!     :cond_77
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
--- 20882,20893 ----
  
      invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
  
!     :cond_77
      add-int/lit8 v25, v25, 0x1
  
      goto :goto_2f
  
!     :cond_78
      const/16 v3, 0x20
  
      move-object/from16 v0, v47
***************
*** 20830,20841 ****
      goto :goto_30
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Instrumentation;
!     :cond_78
!     if-eqz v47, :cond_79
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_79
  
      const-string v3, "PackageManager"
  
--- 20897,20908 ----
      goto :goto_30
  
      .end local v15           #a:Landroid/content/pm/PackageParser$Instrumentation;
!     :cond_79
!     if-eqz v47, :cond_7a
  
      sget-boolean v3, Lcom/android/server/pm/PackageManagerService;->DEBUG_PACKAGE_SCANNING:Z
  
!     if-eqz v3, :cond_7a
  
      const-string v3, "PackageManager"
  
***************
*** 20861,20872 ****
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_79
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;
  
!     if-eqz v3, :cond_7a
  
      move-object/from16 v0, p1
  
--- 20928,20939 ----
  
      invoke-static {v3, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
  
!     :cond_7a
      move-object/from16 v0, p1
  
      iget-object v3, v0, Landroid/content/pm/PackageParser$Package;->protectedBroadcasts:Ljava/util/ArrayList;
  
!     if-eqz v3, :cond_7b
  
      move-object/from16 v0, p1
  
***************
*** 20881,20887 ****
      :goto_31
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_7a
  
      move-object/from16 v0, p0
  
--- 20948,20954 ----
      :goto_31
      move/from16 v0, v25
  
!     if-ge v0, v14, :cond_7b
  
      move-object/from16 v0, p0
  
***************
*** 20903,20909 ****
  
      goto :goto_31
  
!     :cond_7a
      move-object/from16 v0, v45
  
      move-wide/from16 v1, v53
--- 20970,20976 ----
  
      goto :goto_31
  
!     :cond_7b
      move-object/from16 v0, v45
  
      move-wide/from16 v1, v53
***************
*** 20919,20925 ****
      .restart local v30       #j:I
      .restart local v33       #names:[Ljava/lang/String;
      .restart local v40       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_7b
      move-object/from16 v39, v40
  
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
--- 20986,20992 ----
      .restart local v30       #j:I
      .restart local v33       #names:[Ljava/lang/String;
      .restart local v40       #p:Landroid/content/pm/PackageParser$Provider;
!     :cond_7c
      move-object/from16 v39, v40
  
      .end local v40           #p:Landroid/content/pm/PackageParser$Provider;
***************
*** 34475,34480 ****
--- 34542,34552 ----
      .parameter "installerPackageName"
      .parameter "verificationParams"
      .parameter "encryptionParams"
+     .annotation build Landroid/annotation/OppoHook;
+         level = .enum Landroid/annotation/OppoHook$OppoHookType;->CHANGE_CODE:Landroid/annotation/OppoHook$OppoHookType;
+         note = "ZhiYong.Lin@Plf.Framework modify for apk encryption"
+         property = .enum Landroid/annotation/OppoHook$OppoRomType;->ROM:Landroid/annotation/OppoHook$OppoRomType;
+     .end annotation
  
      .prologue
      iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;
***************
*** 34524,34529 ****
--- 34596,34605 ----
  
      invoke-virtual {v0, v11}, Landroid/content/pm/VerificationParams;->setInstallerUid(I)V
  
+     iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mContext:Landroid/content/Context;
+ 
+     invoke-static {v1, p1}, Landroid/content/pm/OppoOpkParserUtil;->checkImeiForOpkByUri(Landroid/content/Context;Landroid/net/Uri;)V
+ 
      iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mHandler:Lcom/android/server/pm/PackageManagerService$PackageHandler;
  
      const/4 v2, 0x5
***************
*** 40439,40441 ****
--- 40515,40567 ----
  
      return-void
  .end method
+ 
+ .method private ignoreOppoFrameworkRes(Ljava/util/HashSet;)V
+     .locals 2
+     .parameter
+     .annotation build Landroid/annotation/OppoHook;
+         level = .enum Landroid/annotation/OppoHook$OppoHookType;->NEW_METHOD:Landroid/annotation/OppoHook$OppoHookType;
+         note = "Jianjun.Dan@Plf.SDK,2013.10.05: to load oppo-framework-res"
+         property = .enum Landroid/annotation/OppoHook$OppoRomType;->ROM:Landroid/annotation/OppoHook$OppoRomType;
+     .end annotation
+ 
+     .annotation system Ldalvik/annotation/Signature;
+         value = {
+             "(",
+             "Ljava/util/HashSet",
+             "<",
+             "Ljava/lang/String;",
+             ">;)V"
+         }
+     .end annotation
+ 
+     .prologue
+     .local p1, libFiles:Ljava/util/HashSet;,"Ljava/util/HashSet<Ljava/lang/String;>;"
+     new-instance v0, Ljava/lang/StringBuilder;
+ 
+     invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V
+ 
+     iget-object v1, p0, Lcom/android/server/pm/PackageManagerService;->mFrameworkDir:Ljava/io/File;
+ 
+     invoke-virtual {v1}, Ljava/io/File;->getPath()Ljava/lang/String;
+ 
+     move-result-object v1
+ 
+     invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+ 
+     move-result-object v0
+ 
+     const-string v1, "/oppo-framework-res.apk"
+ 
+     invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+ 
+     move-result-object v0
+ 
+     invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+ 
+     move-result-object v0
+ 
+     invoke-virtual {p1, v0}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z
+ 
+     return-void
+ .end method
